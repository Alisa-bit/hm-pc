{"version":3,"sources":["webpack:///./src/views/Articles/addArticle.vue?aa21","webpack:///src/views/Articles/addArticle.vue","webpack:///./src/views/Articles/addArticle.vue?9cd5","webpack:///./src/views/Articles/addArticle.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","path","_v","ref","rules","article","model","value","callback","$$v","$set","trim","expression","editorOption","cover","type","key","_e","_l","channel","id","name","on","$event","hAddArticle","staticRenderFns","components","data","placeholder","modules","toolbar","channels","title","content","images","channel_id","methods","hGetChannels","$refs","coveComponent","setImages","validate","valid","message","computed","editor","myeditor","quill","mounted","container","style","height","component"],"mappings":"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","file":"js/addArticle.04cc7875.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"publish-container\"},[_c('el-card',[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"发布文章\")])],1)],1),_c('el-form',{ref:\"articleForm\",attrs:{\"rules\":_vm.rules,\"model\":_vm.article,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.article.title),callback:function ($$v) {_vm.$set(_vm.article, \"title\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"article.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"内容：\",\"prop\":\"content\"}},[_c('quill-editor',{ref:\"myeditor\",attrs:{\"options\":_vm.editorOption},model:{value:(_vm.article.content),callback:function ($$v) {_vm.$set(_vm.article, \"content\", $$v)},expression:\"article.content\"}})],1),_c('el-form-item',{attrs:{\"label\":\"封面\"}},[_c('el-radio-group',{model:{value:(_vm.article.cover.type),callback:function ($$v) {_vm.$set(_vm.article.cover, \"type\", $$v)},expression:\"article.cover.type\"}},[_c('el-radio',{attrs:{\"label\":0}},[_vm._v(\"无图\")]),_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"单图\")]),_c('el-radio',{attrs:{\"label\":3}},[_vm._v(\"三图\")]),_c('el-radio',{attrs:{\"label\":-1}},[_vm._v(\"自动\")])],1),(_vm.article.cover.type>0)?_c('div',{staticClass:\"coverBox\"},[_c('cover',{key:_vm.article.cover.type,ref:\"coveComponent\",attrs:{\"picknum\":_vm.article.cover.type}})],1):_vm._e()],1),_c('el-form-item',{attrs:{\"label\":\"频道\",\"prop\":\"channel_id\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择活动区域\"},model:{value:(_vm.article.channel_id),callback:function ($$v) {_vm.$set(_vm.article, \"channel_id\", $$v)},expression:\"article.channel_id\"}},_vm._l((_vm.channels),function(channel){return _c('el-option',{key:channel.id,attrs:{\"label\":channel.name,\"value\":channel.id}})}),1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.hAddArticle(false)}}},[_vm._v(\"发表\")]),_c('el-button',{on:{\"click\":function($event){return _vm.hAddArticle(true)}}},[_vm._v(\"存入草稿\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"publish-container\">\r\n    <el-card>\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n          <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n          <el-breadcrumb-item>发布文章</el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n      </div>\r\n      <!-- 表单校验：prop+v-model双向绑定的数据名 -->\r\n      <!-- rules 验证规则，v-model必须写 -->\r\n      <el-form ref=\"articleForm\" :rules=\"rules\" :model=\"article\" label-width=\"80px\">\r\n        <el-form-item label=\"标题\" prop=\"title\">\r\n          <el-input v-model.trim=\"article.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"内容：\" prop=\"content\">\r\n          <!-- 使用v-model进行数据的双向绑定 -->\r\n          <quill-editor v-model=\"article.content\" :options=\"editorOption\" ref=\"myeditor\"></quill-editor>\r\n        </el-form-item>\r\n        <el-form-item label=\"封面\">\r\n          <el-radio-group v-model=\"article.cover.type\">\r\n            <!-- 根据后端接口约定 -->\r\n            <el-radio :label=\"0\">无图</el-radio>\r\n            <el-radio :label=\"1\">单图</el-radio>\r\n            <el-radio :label=\"3\">三图</el-radio>\r\n            <el-radio :label=\"-1\">自动</el-radio>\r\n          </el-radio-group>\r\n          <!-- 1、根据当前选择的单选按钮控制自定义组件的显示和隐藏 -->\r\n          <!-- 2、点击图片类型切换图片数量 -->\r\n          <div class=\"coverBox\" v-if=\"article.cover.type>0\">\r\n            <!-- 2.1 当前选中的图片类型绑定的动态值传递给自定义的子组件 -->\r\n            <!-- 分析：通过article.cover.type将选中的图片类型和图片数量连接起来 -->\r\n            <!-- 怎么连接，把 article.cover.type 选中的图片类型当做参数传递给子组件-->\r\n            <!-- 发现问题：点击了单图选择了素材之后，再去点击三图，组件始终显示的只有一个，剩余的不会被渲染出来 -->\r\n            <!-- 解决：子组件标签加key -->\r\n            <!-- 5.2 通过ref获取组件对象,发表文章的时候，\r\n            通过子组件中用于返回缓存图片数组的方法来获取到选择的图片\r\n            将获取到的图片赋值给article.cover.images，在传递给后端-->\r\n            <cover \r\n            :picknum=\"article.cover.type\" \r\n            :key=\"article.cover.type\" \r\n            ref=\"coveComponent\"></cover>\r\n          </div>\r\n        </el-form-item>\r\n        <el-form-item label=\"频道\" prop=\"channel_id\">\r\n          <el-select v-model=\"article.channel_id\" placeholder=\"请选择活动区域\">\r\n            <el-option\r\n              v-for=\"channel in channels\"\r\n              :key=\"channel.id\"\r\n              :label=\"channel.name\"\r\n              :value=\"channel.id\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"hAddArticle(false)\">发表</el-button>\r\n          <el-button @click=\"hAddArticle(true)\">存入草稿</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 引入富文本编辑器\r\nimport { quillEditor } from \"vue-quill-editor\"\r\nimport \"quill/dist/quill.core.css\"\r\nimport \"quill/dist/quill.snow.css\"\r\nimport \"quill/dist/quill.bubble.css\"\r\n\r\nimport { getChannel, add } from \"@/api/article\"\r\n//引入自定义组件\r\nimport Cover from \"./Cover\";\r\n\r\nexport default {\r\n  // 注册组件\r\n  components: { quillEditor, Cover },\r\n  data() {\r\n    return {\r\n      //编辑器的配置项\r\n      editorOption: {\r\n        placeholder: \"\", //占位文字\r\n        modules: {\r\n          toolbar: [\r\n            [\"bold\", \"italic\", \"underline\", \"strike\"],\r\n            [\"blockquote\", \"code-block\"],\r\n            [{ header: 1 }, { header: 2 }],\r\n            [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n            [{ indent: \"-1\" }, { indent: \"+1\" }],\r\n            [\"image\"],\r\n          ],\r\n        },\r\n      },\r\n      channels: [],\r\n      article: {\r\n        title: \"\", // 文章村里\r\n        content: \"\", // 文章内容\r\n        cover: {\r\n          type: 0, // 封面图片的张数\r\n          images: [], // 封面的地址\r\n        },\r\n        channel_id: \"\", // 频道id\r\n      },\r\n      rules: {\r\n        title: [\r\n          { required: true, message: \"不能为空\", trigger: \"blur\" },\r\n          { min: 5, max: 30, message: \"长度在5到30之间\", trigger: \"blur\" },\r\n        ],\r\n        content: [\r\n          { required: true, message: \"请输入文章内容\", trigger: \"blur\" },\r\n          { min: 20, max: 30000, message: \"最少20个字\", trigger: \"blur\" },\r\n        ],\r\n        channel_id: [\r\n          { required: true, message: \"请选择文章频道\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    //获取频道接口的数据，渲染到下拉列表\r\n    hGetChannels() {\r\n      getChannel().then((res) => {\r\n        this.channels = res.data.data.channels;\r\n      });\r\n    },\r\n\r\n    // 发布文章\r\n    hAddArticle(isDraft) {\r\n      // 获取子组件中方法返回的数据\r\n      // 当单选按钮选中无图的时候，下面的子组件是不存在的，所以就不会有this.$refs.coveComponent.setImages()\r\n      // 因此会报错\r\n      // 解决：判断，只有单选按钮选中的类型>0的时候才会显示\r\n      if (this.article.cover.type > 0) {\r\n        this.article.cover.images = this.$refs.coveComponent.setImages();\r\n      }\r\n      //点击按钮，完成一个总的校验\r\n      this.$refs[\"articleForm\"].validate((valid) => {\r\n        if (valid) {\r\n          //valid为true,所有校验通过，执行这个逻辑\r\n          add(isDraft, this.article).then((res) => {\r\n            this.$message({\r\n              message: \"文章发布成功\",\r\n              type: \"success\",\r\n            });\r\n            //发布成功之后，清空内容\r\n            this.article = {\r\n              title: \"\", // 文章村里\r\n              content: \"\", // 文章内容\r\n              cover: {\r\n                type: 0, // 封面图片的张数\r\n                images: [], // 封面的地址\r\n              },\r\n              channel_id: \"\", // 频道id\r\n            };\r\n          });\r\n        } else {\r\n          //valid为false，说明有一个校验没有通过，执行这个逻辑\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    editor() {\r\n      //返回真实的富文本编辑器Quill对象\r\n      return this.$refs.myeditor.quill;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.hGetChannels();\r\n    //this.editor.container包含富文本编辑器的容器盒子容器盒子\r\n    this.editor.container.style.height = `${500}px`;\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./addArticle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./addArticle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./addArticle.vue?vue&type=template&id=60c0d4d5&scoped=true&\"\nimport script from \"./addArticle.vue?vue&type=script&lang=js&\"\nexport * from \"./addArticle.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60c0d4d5\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}